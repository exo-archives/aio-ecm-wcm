<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
           "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>InsertPortalLink</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="expires" content="0">
	<style type="text/css">
		.H-Menu {
			border-bottom: 1px solid orange;
			background-color: #abcdef;
			height: 25px;
		}
		.None .SMenu1 {
			cursor: pointer;
			height: 20px;
			line-height: 20px;
			float: left;
			background-color: #D5D59D;
			padding: 0px 10px 0px 10px;
			margin-top: 4px;
			margin-right: 3px;
			border: 1px solid orange;
			border-bottom: none;
		}
		.None .Display {
			display: none;
			border: 1px solid orange;
			border-top: none;
			height: 246px;
			background: #effffe;
		}
		.B-1 .B-1, .B-2 .B-2, .B-3 .B-3, .B-4 .B-4 {
			display: block;
		}
		.B-1 .A-1, .B-2 .A-2, .B-3 .A-3, .B-4 .A-4 {
			color: black;
			padding-top: 1px;
			background-color: #effffe;
		}
	</style>
</head>
<body>
	<div class="None">
		<div style="position: relative; height: 0px;" id="Root" class="B-1">
			<div class="H-Menu">
				<div class="SMenu1 A-1" onclick="changeClass('B-1')">
					<div>Link Info</div>
				</div>
				<div class="SMenu1 A-2" onclick="changeClass('B-2')">
					<div>Target</div>
				</div>
			</div>
			<div class="Display B-1">

				<div style="padding: 10px;">
					<br>
					Title : <br>
					<input type="text" style="width: 200px;" id="inputTitle"><br><br>
					Url : <br><br>
					<input type="text" style="width: 400px;" id="inputURL"> <input type="button" value="Get portal link" onclick="getPortalLink();"><br><br>
					<input type="button" value="Preview" onclick="previewLink()">
					<input type="button" value="Save" onclick="addURL()">
				</div>
			</div>
			<div class="Display B-2">
				<div style="padding: 10px;">
					<table cellspacing="0" cellpadding="0" width="100%" border="0">
						<tr>
							<td nowrap="nowrap">
								<span fckLang="DlgLnkTarget">Target</span><br />
								<select id="cmbTarget">
									<option value=""selected="selected">&lt;not set&gt;</option>
									<option value="frame" >&lt;frame&gt;</option>
									<option value="popup" >&lt;popup window&gt;</option>
									<option value="_blank" >New Window (_blank)</option>
									<option value="_top" >Topmost Window (_top)</option>
									<option value="_self" >Same Window (_self)</option>
									<option value="_parent" >Parent Window (_parent)</option>
								</select>
							</td>
							<td id="tdTargetFrame" nowrap="nowrap" width="100%">
								<span>Target Frame Name</span><br>
								<input id="txtTargetFrame" style="WIDTH: 100%" type="text">
							</td>
							<td id="tdPopupName" style="DISPLAY: none" nowrap="nowrap" width="100%">
								<span>Popup Window Name</span><br>
								<input id="txtPopupName" style="WIDTH: 100%" type="text">
							</td>
						</tr>
					</table>
				</div>
			</div>
		</div>
	</div>
</body>

<script type="text/javascript">
	//refer form fckdialog.html
	
	var oEditor = window.parent.InnerDialogLoaded();
	var FCKConfig = oEditor.FCKConfig;
	var eXoPlugin = oEditor.FCK.eXoPlugin;
	function changeClass(klass) {
		var Root = document.getElementById("Root");
		Root.className = klass ;
	}
	function Trim(text) {
		if (typeof text == "string") return text.replace(/^\s+|\s+$/g, "");
	}
	function getPortalLink() {
			var width = 800;
			var height = 500;
			var iLeft = ( FCKConfig.ScreenWidth  - width ) / 2 ;
			var iTop  = ( FCKConfig.ScreenHeight - height ) / 2 ;
			var sOptions = "toolbar=no,status=no,resizable=yes,dependent=yes,scrollbars=yes" ;
			sOptions += ",width=" + width ;
			sOptions += ",height=" + height ;
			sOptions += ",left=" + iLeft ;
			sOptions += ",top=" + iTop ;
			var newWindow = window.open( eXoPlugin.ExoPortalLinkBrowserURL, 'eXoImagesBrowseWindow', sOptions );
			newWindow.focus();
	}
	
	function setField(id, value) {
		var field = document.getElementById(id);
		if (!field)  return;
		field.value = value;
	}
	
	function addURL() {
		var content = eXoPlugin.getContent();
		var title = content || document.getElementById("inputTitle").value;
		title = Trim(title);
		var url = document.getElementById("inputURL").value;
		if (Trim(url) == "") {
			alert("Field URL is not empty"); 
			return;
		}
		var newTag = oEditor.FCK.CreateElement( "a" ) ;
		if (title) {
			newTag.innerHTML = title;
		} else {
			newTag.innerHTML = url;
		}
		newTag.setAttribute("href", url);
		window.top.Cancel();
	}
	
	function previewLink() {
		var width = 800;
		var height = 500;
		var iLeft = ( FCKConfig.ScreenWidth  - width ) / 2 ;
		var iTop  = ( FCKConfig.ScreenHeight - height ) / 2 ;
		var sOptions = "toolbar=yes,status=yes,resizable=yes,dependent=yes,scrollbars=yes" ;
		sOptions += ",width=" + width ;
		sOptions += ",height=" + height ;
		sOptions += ",left=" + iLeft ;
		sOptions += ",top=" + iTop ;
		var url = document.getElementById("inputURL").value;
		if (url) window.open(url, "", sOptions);
	}
</script>
</html>