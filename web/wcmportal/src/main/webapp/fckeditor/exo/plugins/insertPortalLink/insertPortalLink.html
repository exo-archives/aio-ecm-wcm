<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
           "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>InsertPortalLink</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="expires" content="0">
	<style type="text/css">
		.None .Display {
			display: none;
			border: 1px solid orange;
			height: 246px;
			background: #effffe;
		}
		.B-1 .B-1 {
			display: block;
		}
	</style>
	<script type="text/javascript">
	//refer form fckdialog.html
	var oEditor = window.parent.InnerDialogLoaded();
	var FCKConfig = oEditor.FCKConfig;
	var eXoPlugin = oEditor.FCK.eXoPlugin;
	</script>
</head>
<body>
	<div class="None">
		<div style="position: relative; height: 0px;" id="Root" class="B-1">
			<div class="Display B-1">
				<div style="padding: 10px;">
					<br>
					Title : <br>
					<input type="text" style="width: 200px;" id="inputTitle"><br><br>
					Url : <br><br>
					<input type="text" style="width: 200px;" id="inputURL"> 
					<input type="button" value="Get portal link" onclick="getPortalLink();">
					<br><br>
					<input type="button" value="Preview" onclick="previewLink()">
					<input type="button" value="Save" onclick="addURL()">
				</div>
			</div>
		</div>
	</div>
</body>

<script type="text/javascript">
	function Trim(text) {
		if (typeof text == "string") return text.replace(/^\s+|\s+$/g, "");
	}
	
	function setPortalName(form) {
		if (!eXoPlugin)  eXoPlugin = oEditor.FCK.eXoPlugin;
		eXoPlugin.portalName = form.options[form.selectedIndex].value;
	}
	
	function getPortalLink() {
			var width = 800;
			var height = 500;
			var iLeft = ( FCKConfig.ScreenWidth  - width ) / 2 ;
			var iTop  = ( FCKConfig.ScreenHeight - height ) / 2 ;
			var sOptions = "toolbar=no,status=no,resizable=yes,dependent=yes,scrollbars=yes" ;
			sOptions += ",width=" + width ;
			sOptions += ",height=" + height ;
			sOptions += ",left=" + iLeft ;
			sOptions += ",top=" + iTop ;
			var newWindow = window.open( eXoPlugin.ExoPortalLinkBrowserURL, 'eXoImagesBrowseWindow', sOptions );
			newWindow.focus();
	}
	
	function setField(id, value) {
		var field = document.getElementById(id);
		if (!field)  return;
		field.value = value;
	}
	
	function addURL() {
		var content = eXoPlugin.getContent();
		var title = content || document.getElementById("inputTitle").value;
		title = Trim(title);
		var url = document.getElementById("inputURL").value;
		if (Trim(url) == "") {
			alert("Field URL is not empty"); 
			return;
		}
		var newTag = oEditor.FCK.CreateElement( "a" );
		if (title) {
			newTag.innerHTML = title;
		} else {
			newTag.innerHTML = url;
		}
		newTag.setAttribute("href", url);
		window.top.Cancel();
	}
	
	function previewLink() {
		var sOptions = "toolbar=no, status=no, resizable=yes, dependent=yes, scrollbars=yes";
		sOptions += ", width=" +  FCKConfig.ScreenWidth;
		sOptions += ", height=" + FCKConfig.ScreenHeight;
		var url = document.getElementById("inputURL").value;
		if (url) window.open(url, "", sOptions);
	}
</script>
</html>