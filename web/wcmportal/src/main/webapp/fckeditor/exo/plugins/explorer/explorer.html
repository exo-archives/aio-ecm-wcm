<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><title>explorer</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="expires" content="0">
	<script type="text/javascript" src="js/kombai.js"></script>
</head>
<body>
	<form name="doc">
		show in folder:
		<input type="text" id="dir" style="width: 256px;" value="/" onkeypress="if(event.keyCode == 13) return false;"/>
		<input type="button" onclick="sendCommand()" value="sendCommand">
	</form>
</body>
<script type="text/javascript">
var eXoPlugin = window.opener.eXoPlugin;
var exp = {
	connector: eXoPlugin.eXoFileManager.Connector,
	resourceType: eXoPlugin.eXoFileManager.ResourceType,
	command: {
		getFiles: "getFiles",
		uploadFile: "uploadFile",
		getFolders: "getFolders",
		createFolder: "createFolder"
	},
	buildParam: function() {
		if (arguments.length < 1) return null;
		var arr = [];
		for (var i = 0; i < arguments.length; ++i) {
			arr.push(arguments[i]);
		}
		return arr.join("&");
	},
	sendRequest: function(connector, param, callback)  {
		Kombai.request({
			address: connector,
			data: param,
			method: "GET",
			onSuccess: function() {
				if (callback && callback instanceof Function) {
					if (this.responseXML) callback(this.responseXML);
					else callback(this.responseText);
				}
			},
			onFailure: function() {
				alert('Can"t connect to sever. Please try again.');
			}
		});
	} 
}



function sendCommand() {
	var connector = eXoPlugin.hostName + exp.connector + exp.command.getFiles;
	var param = exp.buildParam("Type=" + exp.resourceType , "CurrentFolder=/");
	
	function show(idata){
		alert(idata);
	}
	exp.sendRequest(connector, param, show);
}
</script>
</html>
