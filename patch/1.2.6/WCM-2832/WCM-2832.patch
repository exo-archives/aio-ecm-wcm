Index: web/wcmportal/src/main/webapp/WEB-INF/conf/wcm/artifacts/views/templates/ecm-explorer/ContentView.gtmpl
===================================================================
--- web/wcmportal/src/main/webapp/WEB-INF/conf/wcm/artifacts/views/templates/ecm-explorer/ContentView.gtmpl	(revision 48218)
+++ web/wcmportal/src/main/webapp/WEB-INF/conf/wcm/artifacts/views/templates/ecm-explorer/ContentView.gtmpl	(working copy)
@@ -27,10 +27,11 @@
   
   	def viewComponentId  = new Date().getTime();
   	def rcontext = _ctx.getRequestContext() ;
+	def size = uicomponent.getChildrenList().size();
   	rcontext.getJavascriptManager().importJavascript('eXo.ecm.UIListView','/ecm/javascript/'); 
   	rcontext.getJavascriptManager().addOnLoadJavascript("function(){eXo.ecm.UIListView.initAllEvent('${componentId}-$viewComponentId');}");
     rcontext.getJavascriptManager().addOnLoadJavascript("eXo.ecm.UIListView.setHeight");
-    
+    rcontext.getJavascriptManager().addOnLoadJavascript("eXo.ecm.ECMUtils.initClipboard('clip_button','1','$size')");
   	/**
   	 * Finds and returns <code>Node</code> title. If the given node has no title
   	 * value, the name of the node is returned instead.
@@ -189,6 +190,7 @@
 							 </a>
 							<a class="MenuItem" style="display: none;" onclick=eXo.ecm.UIListView.postGroupAction("<%=contextMenu.event('Unlock', 'MultiSelection')%>")> 	
 								<div class="ItemIcon Unlock16x16Icon">
+
 									<%=_ctx.appRes("ECMContextMenu.event.UnLock")%>
 								</div>
 							</a>
@@ -239,7 +241,9 @@
 	      		String portalName = uicomponent.getPortalName() ;
 	      		String repository = uicomponent.getRepository();
 	      		WCMPublicationService wcmPublicationService = uicomponent.getApplicationComponent(WCMPublicationService.class);
+				int i = 0;
 	        	for (data in uicomponent.getChildrenList()) {
+					i++;
 	        		def status = wcmPublicationService.getContentState(data);
 	        		if (status == null) status = "";
 	        		Date date = getDate(data, status); 	        	        
@@ -254,14 +258,16 @@
 	          		String strActs = "<div class=\"RightClickCustomItem\" style=\"display: none;\">" ;
 		        	if (data.getPrimaryNodeType().getName().equals("nt:file")) {
 						String mimeType=data.getNode("jcr:content").getProperty("jcr:mimeType").getString();
-					  	String link ="javascript:eXo.ecm.ECMUtils.generateWebDAVLink('"+serverUrl+"','"+ portalName +"','"+repository+"','"+ preferenceWS+ "','" +Utils.formatNodeName(data.getPath())+"','"+mimeType+"')";				  					  					  	
-					  	strActs += "	<a class=\"MenuItem\" onclick=\"return eXo.webui.UIRightClickPopupMenu.prepareObjectId(this);\" href=\"" + link + "\" >" ;	        
-					  	strActs += "  		<div class=\"ItemIcon WebDAV16x16Icon\">Download And Allow Edition</div>" ;
+						// This escape "'" for js
+	    		  		String webDavPath = nodePath.contains("%27") ? nodePath.replaceAll("%27","%2527") : nodePath;
+						String link ="javascript:eXo.ecm.ECMUtils.generateWebDAVLinkWithoutPortalName('"+serverUrl+ "','"+repository+"','"+ preferenceWS+ "','" + webDavPath + "','"+mimeType+"')";				  					  					  	
+					  	strActs += "	<a class=\"MenuItem\" onclick=\"return eXo.webui.UIRightClickPopupMenu.prepareObjectId(event, this);\" href=\"" + link + "\" >" ;	        
+					  	strActs += "  		<div class=\"ItemIcon WebDAV16x16Icon\">" + _ctx.appRes("ECMContextMenu.event.DownloadAndAllowEdition") + "</div>" ;
 						strActs += "	</a>" ;				  	
 					} else {
 					  	String link = serverUrl + "/" + portalName + "/rest/private/jcr/" + repository+ "/" + preferenceWS + Utils.formatNodeName(data.getPath()); 
-					  	strActs += "	<a class=\"MenuItem\" onclick=\"return eXo.webui.UIRightClickPopupMenu.prepareObjectId(this);\" style=\"{behavior: url(#default#AnchorClick);}\" href=\"" +link + "\" folder=\"" + link +"\">" ;	        
-					  	strActs += "		<div class=\"ItemIcon WebDAV16x16Icon\">Download And Allow Edition</div>" ;
+					  	strActs += "	<a class=\"MenuItem\" onclick=\"return eXo.webui.UIRightClickPopupMenu.prepareObjectId(event, this);\" style=\"{behavior: url(#default#AnchorClick);}\" href=\"" +link + "\" folder=\"" + link +"\">" ;	        
+					  	strActs += "		<div class=\"ItemIcon WebDAV16x16Icon\">" + _ctx.appRes("ECMContextMenu.event.DownloadAndAllowEdition")  + "</div>" ;
 						strActs += "	</a>" ;				  	
 					}
 					//End WebDav Action
@@ -277,7 +283,7 @@
 	            		}            
 	          		}
 	          		String clipboardLink = serverUrl + "/" + portalName + "/rest/jcr/" + repository + "/" + preferenceWS + data.getPath();
-	          		strActs += "	<a class='MenuItem' style='display: block;' onclick=\"eXo.ecm.ECMUtils.pushToClipboard(event,'$clipboardLink');\">" ;
+					strActs +=	"<a class='MenuItem' style='display: block;' id='clip_button1$i' path='$clipboardLink' onclick=\"eXo.ecm.ECMUtils.pushToClipboard(event,'$clipboardLink');\">" ;
 					strActs += "		<div class='MenuURLIcon GetURL16x16Icon'>" ;
 					strActs +=				_ctx.appRes("ECMContextMenu.event.GetURL");
 					strActs += "		</div>" ;
@@ -343,4 +349,4 @@
 			<% 
 		} 
 	%>
-</div>	
\ No newline at end of file
+</div>	
Index: web/wcmportal/src/main/webapp/WEB-INF/conf/wcm/artifacts/views/templates/ecm-explorer/CategoryView.gtmpl
===================================================================
--- web/wcmportal/src/main/webapp/WEB-INF/conf/wcm/artifacts/views/templates/ecm-explorer/CategoryView.gtmpl	(revision 48218)
+++ web/wcmportal/src/main/webapp/WEB-INF/conf/wcm/artifacts/views/templates/ecm-explorer/CategoryView.gtmpl	(working copy)
@@ -26,9 +26,11 @@
   
   	def viewComponentId  = new Date().getTime();
   	def rcontext = _ctx.getRequestContext() ;
+	def size = uicomponent.getChildrenList().size();
   	rcontext.getJavascriptManager().importJavascript('eXo.ecm.UIListView','/ecm/javascript/'); 
-  rcontext.getJavascriptManager().addJavascript("eXo.ecm.UIListView.initAllEvent('${componentId}-$viewComponentId');");
+  	rcontext.getJavascriptManager().addJavascript("eXo.ecm.UIListView.initAllEvent('${componentId}-$viewComponentId');");
     rcontext.getJavascriptManager().addOnLoadJavascript("eXo.ecm.UIListView.setHeight");
+	rcontext.getJavascriptManager().addOnLoadJavascript("eXo.ecm.ECMUtils.initClipboard('clip_button','1','$size')");
     
   	/**
   	 * Finds and returns <code>Node</code> title. If the given node has no title
@@ -236,7 +238,9 @@
 	      		String portalName = uicomponent.getPortalName() ;
 	      		String repository = uicomponent.getRepository();
 	      		WCMPublicationService wcmPublicationService = uicomponent.getApplicationComponent(WCMPublicationService.class);
+				int i = 0;
 	        	for (data in uicomponent.getChildrenList()) {
+					i++;
 	        		def status = wcmPublicationService.getContentState(data);
 	        		if (status == null) status = "";
 	        		Date date = getDate(data, status); 	        	        
@@ -251,14 +255,15 @@
 	          		String strActs = "<div class=\"RightClickCustomItem\" style=\"display: none;\">" ;
 		        	if (data.getPrimaryNodeType().getName().equals("nt:file")) {
 						String mimeType=data.getNode("jcr:content").getProperty("jcr:mimeType").getString();
-					  	String link ="javascript:eXo.ecm.ECMUtils.generateWebDAVLink('"+serverUrl+"','"+ portalName +"','"+repository+"','"+ preferenceWS+ "','" +Utils.formatNodeName(data.getPath())+"','"+mimeType+"')";				  					  					  	
+						String webDavPath = nodePath.contains("%27") ? nodePath.replaceAll("%27","%2527") : nodePath;
+						String link ="javascript:eXo.ecm.ECMUtils.generateWebDAVLinkWithoutPortalName('"+serverUrl+ "','"+repository+"','"+ preferenceWS+ "','" + webDavPath + "','"+mimeType+"')";			
 					  	strActs += "	<a class=\"MenuItem\" onclick=\"return eXo.webui.UIRightClickPopupMenu.prepareObjectId(this);\" href=\"" + link + "\" >" ;	        
-					  	strActs += "  		<div class=\"ItemIcon WebDAV16x16Icon\">Download And Allow Edition</div>" ;
+					  	strActs += "  		<div class=\"ItemIcon WebDAV16x16Icon\">" + _ctx.appRes("ECMContextMenu.event.DownloadAndAllowEdition")  + "</div>" ;
 						strActs += "	</a>" ;				  	
 					} else {
 					  	String link = serverUrl + "/" + portalName + "/rest/private/jcr/" + repository+ "/" + preferenceWS + Utils.formatNodeName(data.getPath()); 
 					  	strActs +=		"<a class=\"MenuItem\" onclick=\"return eXo.webui.UIRightClickPopupMenu.prepareObjectId(this);\" style=\"{behavior: url(#default#AnchorClick);}\" href=\"" +link + "\" target='_new' folder=\"" + link +"\">" ;	        
-					  	strActs += "		<div class=\"ItemIcon WebDAV16x16Icon\">Download And Allow Edition</div>" ;
+					  	strActs += "		<div class=\"ItemIcon WebDAV16x16Icon\">" + _ctx.appRes("ECMContextMenu.event.DownloadAndAllowEdition")  + "</div>" ;
 						strActs += "	</a>" ;				  	
 					}
 					//End WebDav Action
@@ -274,7 +279,7 @@
 	            		}            
 	          		}
 	          		String clipboardLink = serverUrl + "/" + portalName + "/rest/jcr/" + repository + "/" + preferenceWS + data.getPath();
-	          		strActs += "	<a class='MenuItem' style='display: block;' onclick=\"eXo.ecm.ECMUtils.pushToClipboard(event,'$clipboardLink');\">" ;
+					strActs +=	"<a class='MenuItem' style='display: block;' id='clip_button1$i' path='$clipboardLink' onclick=\"eXo.ecm.ECMUtils.pushToClipboard(event,'$clipboardLink');\">" ;
 					strActs += "		<div class='MenuURLIcon GetURL16x16Icon'>" ;
 					strActs +=				_ctx.appRes("ECMContextMenu.event.GetURL");
 					strActs += "		</div>" ;
@@ -335,4 +340,4 @@
 					<%_ctx.renderUIComponent(uicomponent.getContentPageIterator())%>
 				</div>
 	<% } %>
-</div>	
\ No newline at end of file
+</div>	
